{
    "bonds_active": {
        "exclude": [
            "order_id",
            "requiredbondamount",
            "bondamounttaken",
            "renewaldateofbond"
        ],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {
            "orderdate": {
                "mapping_table": "cases.orderdate",
                "direction": "ASC"
            }
        },
        "casrec": {
            "from_table": "order",
            "transform": {
              "bondcompanyname": "replace({col}, '&', 'and')"
            },
            "joins": [
                "LEFT JOIN casrec_csv.pat ON casrec_csv.pat.\"Case\" = casrec_csv.order.\"Case\""
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_bonds_active exc_table ON exc_table.caserecnumber = pat.\"Case\"\n",
            "where_clauses": [
                "casrec_csv.order.\"Bond Rqd\" = 'Y'"
            ]
        },
        "sirius": {
            "from_table": "bonds",
            "transform": {
                "orderdate": "to_char({col}, 'YYYY-MM-DD')",
                "dischargedate": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.cases ON cases.id = bonds.order_id",
                "LEFT JOIN {target_schema}.persons ON persons.id = cases.client_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_bonds_active exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.clientsource = 'CASRECMIGRATION'",
                "bonds.bondcompanyname != 'Security dispensed with'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "bonds_dispensed": {
        "exclude": [
            "order_id",
            "requiredbondamount",
            "bondamounttaken",
            "renewaldateofbond"
        ],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {
            "orderdate": {
                "mapping_table": "cases.orderdate",
                "direction": "ASC"
            }
        },
        "casrec": {
            "from_table": "order",
            "transform": {
              "bondcompanyname": "replace({col}, '&', 'and')"
            },
            "joins": [
                "LEFT JOIN casrec_csv.pat ON casrec_csv.pat.\"Case\" = casrec_csv.order.\"Case\""
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_bonds_dispensed exc_table ON exc_table.caserecnumber = pat.\"Case\"\n",
            "where_clauses": [
                "casrec_csv.order.\"Bond Rqd\" = 'S'"
            ]
        },
        "sirius": {
            "from_table": "bonds",
            "transform": {
                "orderdate": "to_char({col}, 'YYYY-MM-DD')",
                "dischargedate": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.cases ON cases.id = bonds.order_id",
                "LEFT JOIN {target_schema}.persons ON persons.id = cases.client_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_bonds_dispensed exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.clientsource = 'CASRECMIGRATION'",
                "bonds.bondcompanyname = 'Security dispensed with'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "cases": {
        "exclude": [
            "assignee_id",
            "caserecnumber",
            "client_id",
            "correspondent_id",
            "donor_id",
            "feepayer_id",
            "person_id",
            "uid"
        ],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {
            "orderdate": {
                "mapping_table": "cases.orderdate",
                "direction": "ASC"
            }
        },
        "casrec": {
            "from_table": "order",
            "transform": {},
            "joins": [
                "LEFT JOIN casrec_csv.pat ON casrec_csv.pat.\"Case\" = casrec_csv.order.\"Case\""
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_cases exc_table ON exc_table.caserecnumber = pat.\"Case\"",
            "where_clauses": []
        },
        "sirius": {
            "from_table": "cases",
            "transform": {
                "orderdate": "to_char({col}, 'YYYY-MM-DD')",
                "createddate": "to_char({col}, 'YYYY-MM-DD')",
                "orderissuedate": "to_char({col}, 'YYYY-MM-DD')",
                "receiptdate": "to_char({col}, 'YYYY-MM-DD')",
                "orderexpirydate": "to_char({col}, 'YYYY-MM-DD')",
                "updateddate": "to_char({col}, 'YYYY-MM-DD')",
                "clauseexpirydate": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.persons ON persons.id = cases.client_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_cases exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_client'",
                "persons.clientsource = 'CASRECMIGRATION'",
                "cases.casetype = 'ORDER'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "client_addresses": {
        "exclude": [
            "person_id",
            "address_lines"
        ],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {},
        "casrec": {
            "from_table": "pat",
            "transform": {
                "address_lines": "CONCAT(\"Adrs1\", ',', \"Adrs2\")"
            },
            "joins": [],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_addresses exc_table ON exc_table.caserecnumber = pat.\"Case\"",
            "where_clauses": []
        },
        "sirius": {
            "from_table": "addresses",
            "transform": {
                "address_lines": "array_to_string(ARRAY(SELECT json_array_elements_text(addresses.address_lines)), ',')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.persons ON persons.id = addresses.person_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_addresses exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_client'",
                "persons.clientsource = 'CASRECMIGRATION'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "client_death_notifications": {
        "exclude": [
            "person_id"
        ],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {},
        "casrec": {
            "from_table": "pat",
            "transform": {},
            "joins": [],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_death_notifications exc_table ON exc_table.caserecnumber = pat.\"Case\"",
            "where_clauses": [
                "casrec_csv.pat.\"Term Type\" = 'D'"
            ]
        },
        "sirius": {
            "from_table": "death_notifications",
            "transform": {
                "datelettersentout": "to_char({col}, 'YYYY-MM-DD')",
                "datenotified": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.persons ON persons.id = death_notifications.person_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_death_notifications exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_client'",
                "persons.clientsource = 'CASRECMIGRATION'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "client_nodebtchase_warnings": {
        "exclude": [],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {},
        "casrec": {
            "from_table": "pat",
            "transform": {},
            "joins": [],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_nodebtchase_warnings exc_table ON exc_table.caserecnumber = pat.\"Case\"",
            "where_clauses": [
                "casrec_csv.pat.\"Debt chase\" != ''"
            ]
        },
        "sirius": {
            "from_table": "person_warning",
            "transform": {
                "dateadded": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.persons ON persons.id = person_warning.person_id",
                "LEFT JOIN {target_schema}.warnings ON warnings.id = person_warning.warning_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_nodebtchase_warnings exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_client'",
                "persons.clientsource = 'CASRECMIGRATION'",
                "warnings.warningtype = 'Other'",
                "warnings.warningtext = 'Casrec Migration - No Debt to be chased'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "client_persons": {
        "exclude": [
            "caserecnumber",
            "createddate",
            "dateofdeath",
            "middlenames",
            "uid",
            "feepayer_id"
        ],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {},
        "casrec": {
            "from_table": "pat",
            "transform": {},
            "joins": [],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_persons exc_table ON exc_table.caserecnumber = pat.\"Case\"",
            "where_clauses": []
        },
        "sirius": {
            "from_table": "persons",
            "transform": {
                "dob": "to_char({col}, 'YYYY-MM-DD')",
                "createddate": "to_char({col}, 'YYYY-MM-DD')",
                "statusdate": "to_char({col}, 'YYYY-MM-DD')",
                "updateddate": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_persons exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_client'",
                "persons.clientsource = 'CASRECMIGRATION'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "client_phonenumbers": {
        "exclude": [
            "person_id"
        ],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {},
        "casrec": {
            "from_table": "pat",
            "transform": {},
            "joins": [],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_phonenumbers exc_table ON exc_table.caserecnumber = pat.\"Case\"",
            "where_clauses": [
                "casrec_csv.pat.\"Client Phone\" != ''"
            ]
        },
        "sirius": {
            "from_table": "phonenumbers",
            "transform": {
                "updateddate": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.persons ON persons.id = phonenumbers.person_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_phonenumbers exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_client'",
                "persons.clientsource = 'CASRECMIGRATION'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "client_saarcheck_warnings": {
        "exclude": [],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {},
        "casrec": {
            "from_table": "pat",
            "transform": {},
            "joins": [],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_saarcheck_warnings exc_table ON exc_table.caserecnumber = pat.\"Case\"",
            "where_clauses": [
                "casrec_csv.pat.\"SAAR Check\" != ''"
            ]
        },
        "sirius": {
            "from_table": "person_warning",
            "transform": {
                "dateadded": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.persons ON persons.id = person_warning.person_id",
                "LEFT JOIN {target_schema}.warnings ON warnings.id = person_warning.warning_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_saarcheck_warnings exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_client'",
                "persons.clientsource = 'CASRECMIGRATION'",
                "warnings.warningtype = 'Other'",
                "warnings.warningtext = 'Casrec Migration - SAAR Check Warning'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "client_special_warnings": {
        "exclude": [],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {},
        "casrec": {
            "from_table": "pat",
            "transform": {},
            "joins": [],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_special_warnings exc_table ON exc_table.caserecnumber = pat.\"Case\"",
            "where_clauses": [
                "casrec_csv.pat.\"SIM\" != ''",
                "casrec_csv.pat.\"SIM\" != '0'"
            ]
        },
        "sirius": {
            "from_table": "person_warning",
            "transform": {
                "dateadded": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.persons ON persons.id = person_warning.person_id",
                "LEFT JOIN {target_schema}.warnings ON warnings.id = person_warning.warning_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_special_warnings exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_client'",
                "persons.clientsource = 'CASRECMIGRATION'",
                "warnings.warningtype = 'REM - Special Interest Markers'",
                "warnings.warningtext = 'Casrec Migration - Special Interest Warning'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "client_violent_warnings": {
        "exclude": [],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {},
        "casrec": {
            "from_table": "pat",
            "transform": {},
            "joins": [],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_violent_warnings exc_table ON exc_table.caserecnumber = pat.\"Case\"",
            "where_clauses": [
                "casrec_csv.pat.\"VWM\" != ''",
                "casrec_csv.warning_violent_lookup(casrec_csv.pat.\"VWM\") = 'Marker'",
                "casrec_csv.warning_violent_lookup(casrec_csv.pat.\"VWM\") = 'Marker'"
            ]
        },
        "sirius": {
            "from_table": "person_warning",
            "transform": {
                "dateadded": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.persons ON persons.id = person_warning.person_id",
                "LEFT JOIN {target_schema}.warnings ON warnings.id = person_warning.warning_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_client_violent_warnings exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_client'",
                "persons.clientsource = 'CASRECMIGRATION'",
                "warnings.warningtype = 'REM - Violence Warnings'",
                "warnings.warningtext = 'Casrec Migration - Violent Warning'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "crec_persons": {
        "exclude": [
            "supervisioncaseowner_id"
        ],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {},
        "casrec": {
            "from_table": "crec",
            "transform": {},
            "joins": [],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_crec_persons exc_table ON exc_table.caserecnumber = pat.\"Case\"",
            "where_clauses": []
        },
        "sirius": {
            "from_table": "persons",
            "transform": {},
            "joins": [],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_crec_persons exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_client'",
                "persons.clientsource = 'CASRECMIGRATION'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "deputy_daytime_phonenumbers": {
        "exclude": [
            "person_id"
        ],
        "casenumber_source": "cases.caserecnumber",
        "orderby": {
            "casesubtype": {
                "mapping_table": "cases.casesubtype",
                "direction": "ASC"
            },
            "orderdate": {
                "mapping_table": "cases.orderdate",
                "direction": "ASC"
            }
        },
        "casrec": {
            "from_table": "deputyship",
            "transform": {},
            "joins": [
                "LEFT JOIN casrec_csv.order ON casrec_csv.order.\"Order No\" = casrec_csv.deputyship.\"Order No\"",
                "LEFT JOIN casrec_csv.deputy ON casrec_csv.deputyship.\"Deputy No\" = casrec_csv.deputy.\"Deputy No\""
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_deputy_daytime_phonenumbers exc_table ON exc_table.caserecnumber = casrec_csv.order.\"Case\"",
            "where_clauses": [
                "casrec_csv.deputy.\"Contact Telephone\" != ''"
            ]
        },
        "sirius": {
            "from_table": "order_deputy",
            "transform": {
                "orderdate": "to_char({col}, 'YYYY-MM-DD')",
                "updateddate": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.cases ON cases.id = order_deputy.order_id",
                "LEFT JOIN {target_schema}.persons ON persons.id = order_deputy.deputy_id",
                "LEFT JOIN {target_schema}.phonenumbers ON phonenumbers.person_id = persons.id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_deputy_daytime_phonenumbers exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_deputy'",
                "persons.clientsource = 'CASRECMIGRATION'",
                "phonenumbers.type = 'Work'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "deputy_evening_phonenumbers": {
        "exclude": [
            "person_id"
        ],
        "casenumber_source": "cases.caserecnumber",
        "orderby": {
            "casesubtype": {
                "mapping_table": "cases.casesubtype",
                "direction": "ASC"
            },
            "orderdate": {
                "mapping_table": "cases.orderdate",
                "direction": "ASC"
            }
        },
        "casrec": {
            "from_table": "deputyship",
            "transform": {},
            "joins": [
                "LEFT JOIN casrec_csv.order ON casrec_csv.order.\"Order No\" = casrec_csv.deputyship.\"Order No\"",
                "LEFT JOIN casrec_csv.deputy ON casrec_csv.deputyship.\"Deputy No\" = casrec_csv.deputy.\"Deputy No\""
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_deputy_evening_phonenumbers exc_table ON exc_table.caserecnumber = casrec_csv.order.\"Case\"",
            "where_clauses": [
                "casrec_csv.deputy.\"Contact Tele2\" != ''"
            ]
        },
        "sirius": {
            "from_table": "order_deputy",
            "transform": {
                "orderdate": "to_char({col}, 'YYYY-MM-DD')",
                "updateddate": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.cases ON cases.id = order_deputy.order_id",
                "LEFT JOIN {target_schema}.persons ON persons.id = order_deputy.deputy_id",
                "LEFT JOIN {target_schema}.phonenumbers ON phonenumbers.person_id = persons.id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_deputy_evening_phonenumbers exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_deputy'",
                "persons.clientsource = 'CASRECMIGRATION'",
                "phonenumbers.type = 'Home'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "deputy_death_notifications": {
        "exclude": [
            "person_id"
        ],
        "casenumber_source": "cases.caserecnumber",
        "orderby": {
            "casesubtype": {
                "mapping_table": "cases.casesubtype",
                "direction": "ASC"
            },
            "orderdate": {
                "mapping_table": "cases.orderdate",
                "direction": "ASC"
            },
            "email": {
                "mapping_table": "deputy_persons.email",
                "direction": "ASC"
            }
        },
        "casrec": {
            "from_table": "deputy",
            "transform": {},
            "joins": [
                "LEFT JOIN casrec_csv.deputyship ON casrec_csv.deputyship.\"Deputy No\" = casrec_csv.deputy.\"Deputy No\"",
                "LEFT JOIN casrec_csv.order ON casrec_csv.order.\"Order No\" = casrec_csv.deputyship.\"Order No\""
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_deputy_death_notifications exc_table\n    ON exc_table.caserecnumber = deputyship.\"Case\"\n    AND exc_table.casesubtype = casrec_csv.order_type_lookup(casrec_csv.order.\"Ord Type\")\n    AND exc_table.orderdate = casrec_csv.order.\"Made Date\"",
            "where_clauses": [
                "casrec_csv.deputy.\"Stat\" = '99'"
            ]
        },
        "sirius": {
            "from_table": "death_notifications",
            "transform": {
                "datelettersentout": "to_char({col}, 'YYYY-MM-DD')",
                "datedeathcertificatereceived": "to_char({col}, 'YYYY-MM-DD')",
                "datenotified": "to_char({col}, 'YYYY-MM-DD')",
                "orderdate": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.persons ON persons.id = death_notifications.person_id",
                "LEFT JOIN {target_schema}.order_deputy ON order_deputy.deputy_id = death_notifications.person_id",
                "LEFT JOIN {target_schema}.cases ON cases.id = order_deputy.order_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_deputy_death_notifications exc_table ON exc_table.caserecnumber = cases.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_deputy'",
                "persons.clientsource = 'CASRECMIGRATION'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "deputy_feepayer_id": {
        "exclude": [],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {},
        "casrec": {
            "from_table": "pat",
            "transform": {},
            "joins": [],
            "exception_table_join": "",
            "where_clauses": []
        },
        "sirius": {
            "from_table": "persons",
            "transform": {},
            "joins": [],
            "exception_table_join": "",
            "where_clauses": []
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "deputy_persons": {
        "exclude": [
            "caserecnumber",
            "dateofdeath",
            "middlenames",
            "uid"
        ],
        "casenumber_source": "cases.caserecnumber",
        "orderby": {
            "casesubtype": {
                "mapping_table": "cases.casesubtype",
                "direction": "ASC"
            },
            "orderdate": {
                "mapping_table": "cases.orderdate",
                "direction": "ASC"
            }
        },
        "casrec": {
            "from_table": "deputyship",
            "transform": {},
            "joins": [
                "LEFT JOIN casrec_csv.order ON casrec_csv.order.\"Order No\" = casrec_csv.deputyship.\"Order No\"",
                "LEFT JOIN casrec_csv.deputy ON casrec_csv.deputyship.\"Deputy No\" = casrec_csv.deputy.\"Deputy No\"",
                "LEFT JOIN casrec_csv.pat ON casrec_csv.pat.\"Case\" = casrec_csv.order.\"Case\""
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_deputy_persons exc_table\n    ON exc_table.caserecnumber = pat.\"Case\"\n    AND exc_table.casesubtype = casrec_csv.order_type_lookup(casrec_csv.order.\"Ord Type\")\n    AND exc_table.orderdate = casrec_csv.order.\"Made Date\"",
            "where_clauses": []
        },
        "sirius": {
            "from_table": "order_deputy",
            "transform": {
                "orderdate": "to_char({col}, 'YYYY-MM-DD')",
                "dateofdeath": "to_char({col}, 'YYYY-MM-DD')",
                "updateddate": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.cases ON cases.id = order_deputy.order_id",
                "LEFT JOIN {target_schema}.persons ON persons.id = order_deputy.deputy_id",
                "LEFT JOIN {target_schema}.persons AS client ON client.id = cases.client_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_deputy_persons exc_table\n    ON exc_table.caserecnumber = client.caserecnumber\n    AND exc_table.casesubtype = cases.casesubtype\n    AND CAST(exc_table.orderdate AS DATE) = cases.orderdate",
            "where_clauses": [
                "persons.type = 'actor_deputy'",
                "persons.clientsource = 'CASRECMIGRATION'"
            ]
        },
        "manual_checks": {
          "column": "caserecnumber",
          "identifiers": [
            "'12885347'",
            "'11854030'",
            "'11509969'",
            "'11065340'",
            "'99379589'",
            "'12138872'",
            "'11741056'",
            "'12742084'",
            "'13097967'",
            "'1208622T'",
            "'12913439'"
          ]
        }
    },
    "deputy_special_warnings": {
        "exclude": [],
        "casenumber_source": "cases.caserecnumber",
        "orderby": {
            "casesubtype": {
                "mapping_table": "cases.casesubtype",
                "direction": "ASC"
            },
            "orderdate": {
                "mapping_table": "cases.orderdate",
                "direction": "ASC"
            }
        },
        "casrec": {
            "from_table": "deputyship",
            "transform": {
                "dateadded": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN casrec_csv.order ON casrec_csv.order.\"Order No\" = casrec_csv.deputyship.\"Order No\"",
                "LEFT JOIN casrec_csv.deputy ON casrec_csv.deputyship.\"Deputy No\" = casrec_csv.deputy.\"Deputy No\""
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_deputy_special_warnings exc_table ON exc_table.caserecnumber = casrec_csv.order.\"Case\"",
            "where_clauses": [
                "casrec_csv.deputy.\"SIM\" != ''",
                "casrec_csv.deputy.\"SIM\" != '0'"
            ]
        },
        "sirius": {
            "from_table": "order_deputy",
            "transform": {
                "orderdate": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.cases ON cases.id = order_deputy.order_id",
                "LEFT JOIN {target_schema}.persons ON persons.id = order_deputy.deputy_id",
                "LEFT JOIN {target_schema}.person_warning ON person_warning.person_id = order_deputy.deputy_id",
                "LEFT JOIN {target_schema}.warnings ON person_warning.warning_id = warnings.id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_deputy_special_warnings exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_deputy'",
                "persons.clientsource = 'CASRECMIGRATION'",
                "warnings.warningtype = 'REM - Special Interest Markers'",
                "warnings.warningtext = 'Casrec Migration - Special Interest Warning'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "deputy_violent_warnings": {
        "exclude": [],
        "casenumber_source": "cases.caserecnumber",
        "orderby": {
            "casesubtype": {
                "mapping_table": "cases.casesubtype",
                "direction": "ASC"
            },
            "orderdate": {
                "mapping_table": "cases.orderdate",
                "direction": "ASC"
            }
        },
        "casrec": {
            "from_table": "deputyship",
            "transform": {},
            "joins": [
                "LEFT JOIN casrec_csv.order ON casrec_csv.order.\"Order No\" = casrec_csv.deputyship.\"Order No\"",
                "LEFT JOIN casrec_csv.deputy ON casrec_csv.deputyship.\"Deputy No\" = casrec_csv.deputy.\"Deputy No\""
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_deputy_violent_warnings exc_table ON exc_table.caserecnumber = casrec_csv.order.\"Case\"",
            "where_clauses": [
                "casrec_csv.warning_violent_lookup(casrec_csv.deputy.\"VWM\") = 'Marker'"
            ]
        },
        "sirius": {
            "from_table": "order_deputy",
            "transform": {
                "orderdate": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.cases ON cases.id = order_deputy.order_id",
                "LEFT JOIN {target_schema}.persons ON persons.id = order_deputy.deputy_id",
                "LEFT JOIN {target_schema}.person_warning ON person_warning.person_id = order_deputy.deputy_id",
                "LEFT JOIN {target_schema}.warnings ON person_warning.warning_id = warnings.id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_deputy_violent_warnings exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_deputy'",
                "persons.clientsource = 'CASRECMIGRATION'",
                "warnings.warningtype = 'REM - Violence Warnings'",
                "warnings.warningtext = 'Casrec Migration - Violent Warning'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "notes": {
        "exclude": [
            "upload_id",
            "document_id",
            "person_id"
        ],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {},
        "casrec": {
            "from_table": "remarks",
            "transform": {},
            "joins": [
                "LEFT JOIN casrec_csv.pat ON casrec_csv.pat.\"Case\" = casrec_csv.remarks.\"Case\""
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_notes exc_table ON exc_table.caserecnumber = pat.\"Case\"",
            "where_clauses": []
        },
        "sirius": {
            "from_table": "supervision_notes as notes",
            "transform": {
                "createdtime": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.persons ON persons.id = notes.person_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_notes exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "persons.type = 'actor_client'",
                "persons.clientsource = 'CASRECMIGRATION'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "supervision_level_log": {
        "exclude": [
            "order_id"
        ],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {},
        "casrec": {
            "from_table": "order",
            "transform": {},
            "joins": [
                "LEFT JOIN casrec_csv.pat ON casrec_csv.pat.\"Case\" = casrec_csv.order.\"Case\""
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_supervision_level_log exc_table ON exc_table.caserecnumber = pat.\"Case\"",
            "where_clauses": []
        },
        "sirius": {
            "from_table": "supervision_level_log",
            "transform": {
                "createddate": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.cases ON cases.id = supervision_level_log.order_id",
                "LEFT JOIN {target_schema}.persons ON persons.id = cases.client_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_supervision_level_log exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": []
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "tasks": {
        "exclude": [
            "completedby_id"
        ],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {},
        "casrec": {
            "from_table": "SUP_ACTIVITY",
            "transform": {},
            "joins": [
                "LEFT JOIN casrec_csv.pat ON casrec_csv.pat.\"Case\" = casrec_csv.sup_activity.\"Case\""
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_tasks exc_table ON exc_table.caserecnumber = pat.\"Case\"",
            "where_clauses": [
                "casrec_csv.sup_activity.\"Status\" IN ('INACTIVE','ACTIVE')"
            ]
        },
        "sirius": {
            "from_table": "tasks",
            "transform": {
                "createdtime": "to_char({col}, 'YYYY-MM-DD')",
                "activedate": "to_char({col}, 'YYYY-MM-DD')",
                "duedate": "to_char({col}, 'YYYY-MM-DD')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.person_task pt ON pt.task_id = tasks.id",
                "LEFT JOIN {target_schema}.persons ON persons.id = pt.person_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_tasks exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": [
                "tasks.status = 'Not started'",
                "persons.type = 'actor_client'"
            ]
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    },
    "visits": {
        "exclude": [
            "client_id"
        ],
        "casenumber_source": "client_persons.caserecnumber",
        "orderby": {},
        "casrec": {
            "from_table": "REPVIS",
            "transform": {},
            "joins": [
                "LEFT JOIN casrec_csv.pat ON casrec_csv.pat.\"Case\" = casrec_csv.REPVIS.\"Case\""
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_visits exc_table ON exc_table.caserecnumber = REPVIS.\"Case\"",
            "where_clauses": []
        },
        "sirius": {
            "from_table": "visits",
            "transform": {
                "visitcreateddate": "to_char({col}, 'YYYY-MM-DD HH24:MI:SS')",
                "visitreportduedate": "to_char({col}, 'YYYY-MM-DD HH24:MI:SS')",
                "visitcompleteddate": "to_char({col}, 'YYYY-MM-DD HH24:MI:SS')",
                "visitreportreceiveddate": "to_char({col}, 'YYYY-MM-DD HH24:MI:SS')",
                "visitreportrevieweddate": "to_char({col}, 'YYYY-MM-DD HH24:MI:SS')",
                "visitcommissiondate": "to_char({col}, 'YYYY-MM-DD HH24:MI:SS')",
                "firstextendedvisitreportduedate": "to_char({col}, 'YYYY-MM-DD HH24:MI:SS')",
                "secondextendedvisitreportduedate": "to_char({col}, 'YYYY-MM-DD HH24:MI:SS')"
            },
            "joins": [
                "LEFT JOIN {target_schema}.persons ON persons.id = visits.client_id"
            ],
            "exception_table_join": "LEFT JOIN casrec_csv.exceptions_visits exc_table ON exc_table.caserecnumber = persons.caserecnumber",
            "where_clauses": []
        },
        "manual_checks": {
          "column": "",
          "identifiers": []
        }
    }
}
